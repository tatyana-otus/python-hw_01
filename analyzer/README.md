# Log Analyzer: парсер логов nginx с агрегацией статистика по URL'ам и рендером html‐отчета

## Основная функциональность:
1. Скрипт обрабатывает при запуске последний (со самой свежей датой в имени, не по mtime файла!) лог в
`LOG_DIR` , в результате работы должен получится отчет как в `report-2017.06.30.html` (для корректной работы
нужно будет найти и принести себе на диск `jquery.tablesorter.min.js` ). То есть скрипт читает лог, парсит
нужные поля, считает необходимую статистику по url'ам и рендерит шаблон `report.html` (в шаблоне нужно
только подставить `$table_json` ). Ситуация, что логов на обработку нет возможна, это не должно являться
ошибкой.
2. Если удачно обработал, то работу не переделывает при повторном запуске. Готовые отчеты лежат в
`REPORT_DIR` . В отчет попадает `REPORT_SIZE` URL'ов с наибольшим суммарным временем обработки
( time_sum ).
3. Скрипту должно быть возможно указать считать конфиг из другого файла, передав его путь через `--config` .
У пути конфига должно быть дефолтное значение. Если файл не существует или не парсится, нужно выходить
с ошибкой.
4. В переменной `config` находится конфиг по умолчанию (и его не надо выносить в файл). В конфиге, считанном
из файла, могут быть переопределены перменные дефолтного конфига (некоторые, все или никакие, т.е. файл
может быть пустой) и они имеют более высокий приоритет по сравнению с дефолтным конфигом. Таким
образом, результирующий конфиг получается слиянием конфига из файла и дефолтного, с приоритетом
конфига из файла.

##  Отчет:
* `count` ‐ сколько раз встречается URL, абсолютное значение
* `count_perc` ‐ сколько раз встречается URL, в процентнах относительно общего числа запросов
* `time_sum` ‐ суммарный `$request_time` для данного URL'а, абсолютное значение
* `time_perc` ‐ суммарный `$request_time` для данного URL'а, в процентах относительно общего `$request_time` всех
запросов
* `time_avg` ‐ средний `$request_time` для данного URL'а
* `time_max` ‐ максимальный `$request_time` для данного URL'а
* `time_med` ‐ медиана `$request_time` для данного URL'а
## Пример использования
```
python3 ./log_analyzer.py [--config ./path_to_config/some_analyzer.cfg]
```
Если опция --config не указана, используется файл `analyzer.cfg` из текущей директории

### Пример файла `analyzer.cfg`
```
[Common]
REPORT_SIZE: 50
LOG_DIR: .
REPORT_DIR: .

[Log]
LOG_FILE:log_analyzer.log
```
Файл `*.cfg` переопределяет дефолтные значения.

### Дефолтные значения конфигурации
```
[Common]
REPORT_SIZE: 1000,
REPORT_DIR: .
LOG_DIR: .
```
По умолчанию лог пишется stdout, если не указано иное в фале конфигурации: в секции `[Log]` значение `LOG_FILE`
## Тестирование:
```
python3 ./test_log_analyzer.py
```